<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
<!--FORMULARIO-->
<div class="col-md-12 col-sm-12 ">
	<div class="x_panel">
		<div class="x_title">
			<h2>Formulario <small>Creación de nuevos usuarios</small></h2>

			<ul class="nav navbar-right panel_toolbox">
				<li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
				<li><a class="close-link"><i class="fa fa-close"></i></a></li>
			</ul>
			<div class="clearfix">
			</div>
			</div>
			<div class="x_content">
			<br/>
			<form name="ignresoUsuario" id="ignresoUsuario" data-parsley-validate class="form-horizontal form-label-left"  action="/mantenedores/addUsuario" method="POST">
				<div class="item form-group">
					<label class="col-form-label col-md-3 col-sm-3 label-align" for="Nombre">Nombre<span class="required">*</span>
					</label>
					<div class="col-md-6 col-sm-6 ">
						<input type="text" id="Nombre" name="Nombre" required="required" class="form-control">
					</div>
				</div>
				<div class="item form-group">
					<label class="col-form-label col-md-3 col-sm-3 label-align" for="Email">E-mail<span class="required">*</span>
					</label>
					<div class="col-md-6 col-sm-6 ">
						<input type="email" id="Email" name="Email" required="required" class="form-control">
					</div>
				</div>
				<div class="item form-group">
					<label class="col-form-label col-md-3 col-sm-3 label-align" for="Telefono">Teléfono<span class="required">*</span>
					</label>
					<div class="col-md-6 col-sm-6 ">
						<input type="text" id="Telefono" name="Telefono" required="required" class="form-control">
					</div>
				</div>
				<div class="item form-group">
					<label class="col-form-label col-md-3 col-sm-3 label-align" for="login">Login<span class="required">*</span>
					</label>
					<div class="col-md-6 col-sm-6 ">
						<input type="text" id="login" name="login" required="required" class="form-control">
					</div>
				</div>
				<div class="form-group row">
					<label class="col-form-label col-md-3 col-sm-3 label-align">Categoría</label>
					<div class="col-md-6 col-sm-6 ">
						<select class="select2_single form-control" tabindex="-1" name="idCategoria">
							{{#each categoria}}
								<option value="{{id_Categoria}}">{{categoria}}</option>
							{{/each}}
						</select>
					</div>
				</div>
	        	<div class="form-group row">
					<label class="col-form-label col-md-3 col-sm-3 label-align">Sucursal</label>
					<div class="col-md-6 col-sm-6 ">
						<select class="select2_single form-control" tabindex="-1" name="idSucursal">
							{{#each sucursal}}
								<option value="{{id_Sucursal}}">{{direccion}}</option>
							{{/each}}
						</select>
					</div>
				</div>
				<div class="item form-group">
					<label class="col-form-label col-md-3 col-sm-3 label-align" for="titulo">Título<span class="required">*</span>
					</label>
					<div class="col-md-6 col-sm-6 ">
						<input type="text" id="titulo" name="titulo"  required="required" class="form-control">
					</div>
				</div>
				<div class="ln_solid"></div>
				<div class="form-group">
					<div class="col-md-9 col-sm-9  offset-md-3">
						<!--<button type="button" class="btn btn-primary">Cancelar</button>-->
						<button type="button"  onclick="ValidarIngreso();" class="btn btn-success">Guardar</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>


<script>

function ValidarIngreso ( )
	{
		//_________________________________________
		var dataIngreso = $("#ignresoUsuario").serialize();
		//_________________________________________
		//alert("ASDF");	

		$.ajax({
				method:'POST',
				url : '/mantenedores/ajax-validarNombreLogin',
				data : dataIngreso,
				success : function(result)
				{
					//alert(result);
					if(!$.trim(result)){
						// no existe resultado esta en lo correcto
						document.getElementById("ignresoUsuario").submit();
					}
					else{
						toastr.warning('warning', 'No se pueden crear un usuario con un login existente', {
							"progressBar": true
						});
					}
				}
				});

	}

</script>
