<!doctype html>
<html lang="en">
<style>
    .col-form-label {
    padding-top: calc(0.2rem + 1px);
    padding-bottom: calc(0.2rem + 1px);
    margin-bottom: 0;
    font-size: inherit;
    line-height: 1.5;
}
.close {
            float: right;
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1;
            color: #000;
            text-shadow: 0 1px 0 #fff;
            opacity: .5;
        }
        .close:not(:disabled):not(.disabled) {
            cursor: pointer;
        }
        button.close {
            padding: 0;
            background-color: transparent;
            border: 0;
            -webkit-appearance: none;
        }
</style>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <!-- <link rel="stylesheet" href="/resources/demos/style.css"> -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">


</head>
<body>
    
    <div class="col-md-12">
        <div class="x_panel">
            <div class="x_title">
                <h2>{{proyecto.year}}-{{proyecto.code}} : {{proyecto.nombre}}</h2>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <a class="nav-link active" id="resultados-tab" data-toggle="tab" href="#resultados" role="tab" aria-controls="resultados" aria-selected="true">Resultados</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" id="cinterno-tab" data-toggle="tab" href="#cinterno" role="tab" aria-controls="cinterno" aria-selected="false">Costo Interno</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" id="cexterno-tab" data-toggle="tab" href="#cexterno" role="tab" aria-controls="cexterno" aria-selected="false">Costo Externo</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" id="facturacion-tab" data-toggle="tab" href="#facturacion" role="tab" aria-controls="facturacion" aria-selected="false">Facturación</a>
                </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="resultados" role="tabpanel" aria-labelledby="resultados-tab">
                    &nbsp;
                     <div class="row">
                                 <div class="col-4">
                                     <div class="x_panel">
                                        <div class="x_title">
                                            <h2> <small> Antecedentes Generales </small></h2>
                                            <div class="clearfix"></div>
                                        </div>
                                        <div class="x_content">
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="Estado"><b>Estado</b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.descripcion}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="porcAvance"><b>% Avance</b></label>
                                                    <div class="col-9">##################</div>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="nombre"><b>Nombre</b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.nombre}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="codigo"><b>Código</b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.year}}-{{proyecto.code}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="cliente"><b>Cliente</b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.nomCliente}}</label>
                                            </div>
                                            <div class="row">
                                                     <label class="col-form-label col-md-3 label-align" for="director"><b>Director</b></label> 
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.nomDire}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="jdp"><b>Jefe Proyecto</b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.nomJefe}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="tipologia"><b>Tipología</b></label> 
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.tipologia}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="tipologia"><b>Superficie m<sup>2</sup></b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.superficie_pre}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="tarifa"><b>Tarifa UF/m<sup>2</sup></b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.valor_metro_cuadrado}}</label>
                                            </div>
                                            <div class="row">
                                                    <label class="col-form-label col-md-3 label-align" for="numplanos"><b>Nº Planos</b></label>
                                                    <label class="col-form-label col-md-9 " for="nombre">{{proyecto.num_plano_estimado}}</label>
                                            </div>
                                        </div>
                                      </div>
                                 </div>
                                 <div class="col-9">

                                 </div>
                            </div>
                </div>
                <div class="tab-pane fade" id="cinterno" role="tabpanel" aria-labelledby="cinterno-tab">
                   &nbsp;
                   <div class="row">
                       <div class="col-2">
                           <table class="table" style="text-align: center;">
											  <thead>
												<tr>
												  <th ></th>
												  <th style="background-color: #ddd;">Horas Ingresadas</th>
												</tr>
											  </thead>
											  <tbody>
                                                  {{#each centro_costo}}
                                                    <tr>
                                                        <th style="background-color: #ddd;">{{centroCosto}}</th>
                                                        <td>{{t}}</td>
                                                    </tr>
                                                    {{/each}}
												<tr>
												  <th style="background-color: #ddd;">Externo</th>
												  <td>{{numHH}}</td>
												</tr>
												<tr>
												  <th style="background-color: #ddd;">Totales</th>
												  <td>{{varTotalProyecto}}</td>
												</tr>
											  </tbody>
											</table>
                       </div>
                       <div class="col-5">
                            <table class="table table-hover" id="tablaCinternos">
                                        <thead>
                                            <tr>
                                                <th>Colaborador</th>
                                                <th>Nº HH</th>
                                                <th>Nº HE</th>
                                                <th>Costo</th>
                                                <th>Total HH </th>
                                                <th>% participación</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {{#each cinternos}}
                                                <tr>
                                                    <td>{{nombre}}</td>
                                                    <td>{{numHH}}</td>
                                                    <td>{{numHE}}</td>
                                                    <td>{{costo}}</td>
                                                    <td>{{t}}</td>
                                                    <td>{{totalPro}}</td>
                                                </tr>
                                            {{/each}}
                                        </tbody>
                            </table>
                       </div>
                       <div class="col-5">
                           <div class="chart-container">
                            <canvas id="myChart"></canvas>
                           </div>
                           <div>
                                {{#if mensaje }}
                                    <!-- Button trigger modal -->
                                    <button type="button" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#exampleModalCenter">
                                    ver Problemas
                                    </button>

                                    <!-- Modal -->
                                    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered" role="document">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLongTitle">Costo Mensual por cargar</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                          <table class="table table-hover" >
                                                <thead>
                                                    <tr>
                                                        <th>Fecha</th>
                                                        <th>Colaborador</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {{#each erroresCosto}}
                                                        <tr>
                                                            <td>{{annio}}-{{mes}}</td>
                                                            <td>{{nombre}}</td>
                                                        </tr>
                                                    {{/each}}
                                                </tbody>
                                            </table>
                                        </div>
                                        </div>
                                    </div>
                                    </div>
                                {{/if}}
                                </div>
                       </div>
                   </div>
                </div>
                <div class="tab-pane fade" id="cexterno" role="tabpanel" aria-labelledby="cexterno-tab">
                                        &nbsp;
                    <table class="table table-hover" id="tablaCexternos">
                                <thead>
                                    <tr>
                                        <th>Centro Costo</th>
                                        <th>Moneda</th>
                                        <th>Descripción</th>
                                        <th>Nº OC</th>
                                        <th>Nº Horas</th>
                                        <th>Costo</th>
                                        <th>Total Proyecto</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {{#each cexternos}}
                                        <tr>
                                            <td>{{ccosto}}</td>
                                            <td>{{moneda}}</td>
                                            <td>{{descripcion}}</td>
                                            <td>{{numoc}}</td>
                                            <td>{{numhh}}</td>
                                            <td>{{costo}}</td>
                                            <td>{{totPro}}</td>
                                        </tr>
                                    {{/each}}
                                </tbody>
                            </table>
                </div>
                <div class="tab-pane fade" id="facturacion" role="tabpanel" aria-labelledby="facturacion-tab">
                    &nbsp;
                    <table class="table table-hover" id="tablaFacturas">
                                <thead>
                                    <tr>
                                        <th>Solicitó</th>
                                        <th>Monto Facturado</th>
                                        <th>% PPto</th>
                                        <th>Moneda</th>
                                        <th>Es roc</th>
                                        <th>Tipo Cobro</th>
                                        <th>Fecha Pago</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {{#each facturas}}
                                        <tr>
                                            <td>{{Nombre}}</td>
                                            <td>{{monto_a_facturar}}</td>
                                            <td>{{porc_ppto}}</td>
                                            <td>{{moneda}}</td>
                                            <td>{{roc}}</td>
                                            <td>{{tipoCobro}}</td>
                                            <td>{{fecha_pago}}</td>
                                        </tr>
                                    {{/each}}
                                </tbody>
                            </table>
                </div>
                </div>
            </div>
        </div>
    </div>

</body>
 
 <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

 <script src="../../../template/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
 <script src="../../../template/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script> 
 <script src="../../../template/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>

<script>
      $('#tablaFacturas').DataTable({
          "dom": "<'row'<'col-sm-12 col-md-6'f><'col-sm-12 col-md-6'l>>" +
                "<'row'<'col-sm-12'tr>>" +
                "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
        language: {
          "decimal": "",
          "emptyTable": "No hay información",
          "info": "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
          "infoEmpty": "Mostrando 0 to 0 of 0 Entradas",
          "infoFiltered": "(Filtrado de _MAX_ total entradas)",
          "infoPostFix": "",
          "thousands": ",",
          "lengthMenu": "Mostrar _MENU_ Entradas",
          "loadingRecords": "Cargando...",
          "processing": "Procesando...",
          "search": "Buscar:",
          "zeroRecords": "Sin resultados encontrados",
          "paginate": {
            "first": "Primero",
            "last": "Ultimo",
            "next": "Siguiente",
            "previous": "Anterior"
          }
        }
      });
       $('#tablaCexternos').DataTable({
          "dom": "<'row'<'col-sm-12 col-md-6'f><'col-sm-12 col-md-6'l>>" +
                "<'row'<'col-sm-12'tr>>" +
                "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
        language: {
          "decimal": "",
          "emptyTable": "No hay información",
          "info": "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
          "infoEmpty": "Mostrando 0 to 0 of 0 Entradas",
          "infoFiltered": "(Filtrado de _MAX_ total entradas)",
          "infoPostFix": "",
          "thousands": ",",
          "lengthMenu": "Mostrar _MENU_ Entradas",
          "loadingRecords": "Cargando...",
          "processing": "Procesando...",
          "search": "Buscar:",
          "zeroRecords": "Sin resultados encontrados",
          "paginate": {
            "first": "Primero",
            "last": "Ultimo",
            "next": "Siguiente",
            "previous": "Anterior"
          }
        }
      });
             $('#tablaCinternos').DataTable({
          "dom": "<'row'<'col-sm-12 col-md-6'f><'col-sm-12 col-md-6'l>>" +
                "<'row'<'col-sm-12'tr>>" +
                "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
        language: {
          "decimal": "",
          "emptyTable": "No hay información",
          "info": "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
          "infoEmpty": "Mostrando 0 to 0 of 0 Entradas",
          "infoFiltered": "(Filtrado de _MAX_ total entradas)",
          "infoPostFix": "",
          "thousands": ",",
          "lengthMenu": "Mostrar _MENU_ Entradas",
          "loadingRecords": "Cargando...",
          "processing": "Procesando...",
          "search": "Buscar:",
          "zeroRecords": "Sin resultados encontrados",
          "paginate": {
            "first": "Primero",
            "last": "Ultimo",
            "next": "Siguiente",
            "previous": "Anterior"
          }
        }
      });

$(document).ready(function(){
    
    $.ajax({
        url: "horas/1985",
        dataType: 'json',
        contentType: "application/json; charset=utf-8",
        method: "GET",
        success: function(data) {
            var nombre = [];
            var stock = [];
            var color = ['rgba(239, 223, 0)', 'rgba(254, 80, 0)', 'rgba(218, 24, 132)', 'rgba(0, 119,200)', 'rgba(0, 159, 77)', 'rgba(0, 174, 255)', 'rgba(142, 192, 108)',];
            //var bordercolor = ['rgba(255,99,132,1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)'];
 
            for (var i in data) {
                nombre.push(data[i].nombre);
                stock.push(data[i].t);
            }
 
            var chartdata = {
                labels: nombre,
                datasets: [{
                    label: nombre,
                    backgroundColor: color,
                    borderColor: color,
                    borderWidth: 2,
                    hoverBackgroundColor: color,
                   // hoverBorderColor: bordercolor,
                    data: stock
                }]
            };
 
            var mostrar = $("#myChart");
 
            var grafico = new Chart(mostrar, {
                type: 'doughnut',
                data: chartdata,
                options: {
                    responsive: true
                }
            });
        },
        error: function(data) {
            console.log(data);
        }
    });
});

</script>

</html>