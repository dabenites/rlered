    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">

    <div class="col-md-4 col-sm-4  ">
        <div class="x_panel">
            <div class="x_title">
                <h2>Crear Configuración General</h2>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <div class="form-group row">
                            <label for="staticEmail" class="col-sm-2 col-form-label">Proyecto</label>
                            <div class="col-sm-8">
                                <select class="form-control" name="id_proyecto" id="id_proyecto" >
                                    <option>Seleccione un proyecto</option>
                                        {{#each proyectos}}
                                            <option value="{{id}}">{{year}}_{{code}} {{nombre}}</option>
                                        {{/each}}
                                </select>
                            </div>
                </div>
                <div class="form-group row">
                            <label for="staticEmail" class="col-sm-2 col-form-label">Origen</label>
                            <div class="col-sm-8">
                                <select class="form-control" name="id_origen" id="id_origen" >
                                    <option>Seleccione un Origen</option>
                                        {{#each origenes}}
                                            <option value="{{id_origen}}">{{descripcion}}</option>
                                        {{/each}}
                                </select>
                            </div>
                </div>
                <div class="form-group row">
                    <label for="staticEmail" class="col-sm-2 col-form-label">Código</label>
                      <div class="col-sm-8">
                        <input type="text" id="codigo" class="form-control" value="{{centro.centroCosto}}" name="codigo" required />
                      </div>
                    
                </div>
                <div class="form-group row">
                    <button type="button" class="btn btn-warning btn-block" onclick="validarIngresoCodigo();">
                                        Ingresar
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-6">
        <div class="x_panel">
            <div class="x_title">
                <h2>Listado Configuracion Inicial de Proyectos</h2>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                    <table class="table table-hover" name="tablaCodigos" id="tablaCodigos" style="width: 100%;">
                            <thead>
                                <tr>
                                        <th>Proyecto</th>
                                        <th>Origen</th>
                                        <th>Código</th>
                                        <th>Opciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                 {{#each codigos}}
                                 <tr>
                                        <td>{{nombre}}</td>
                                        <td>{{descripcion}}</td>
                                        <td>{{annio}}_{{code}}</td>
                                        <td>
                                            <a href="/revit/seteoProyecto/{{id}}">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                                            <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"/>
                                            </svg>
                                            </a>

                                        </td>
                                </tr>
                                 {{/each}} 
                            </tbody>
                    </table>
            </div>
        </div>
    </div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="../../../template/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../../../template/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script> 
<script src="../../../template/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<script>

            var table = $('#tablaCodigos').DataTable({
             "dom": "<'row'<'col-sm-12 col-md-6'f><'col-sm-12 col-md-6'l>>" +
                "<'row'<'col-sm-12'tr>>" +
                "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
            orderCellsTop: true,
            fixedHeader: true,
            "scrollX": true,
            language: {
                "decimal": ".",
                "thousands": ",",
                "emptyTable": "No hay información",
                "info": "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
                "infoEmpty": "Mostrando 0 to 0 of 0 Entradas",
                "infoFiltered": "(Filtrado de _MAX_ total entradas)",
                "infoPostFix": "",
                "thousands": ",",
                "lengthMenu": "Mostrar _MENU_ Entradas",
                "loadingRecords": "Cargando...",
                "processing": "Procesando...",
                "search": "Buscar:",
                "zeroRecords": "Sin resultados encontrados",
                "paginate": {
                    "first": "Primero",
                    "last": "Ultimo",
                    "next": "Siguiente",
                    "previous": "Anterior"
                }
            }
        });


            if ("{{verToask.tipo}}" == "Editar") {
        toastr.warning('{{verToask.body}}', '{{verToask.titulo}}', {
            "progressBar": true
        });
    }
    else if ("{{verToask.tipo}}" == "Crear") {
        toastr.success('{{verToask.body}}', '{{verToask.titulo}}', {
            "progressBar": true
        });
    }
    else if ("{{verToask.tipo}}" == "Eliminar") {
        toastr.error('{{verToask.body}}', '{{verToask.titulo}}', {
            "progressBar": true
        });
    }
    else if ("{{verToask.tipo}}" == "Permisos") {
        toastr.success('{{verToask.body}}', '{{verToask.titulo}}', {
            "progressBar": true
        });
    }


function validarIngresoCodigo()
{

     let id_proyecto = $("#id_proyecto").val();
     let id_origen   = $("#id_origen").val();
     let codigo      = $("#codigo").val();


        if (id_proyecto != "" &&
            id_origen != "" && 
            codigo != "")
            {
                    let informacion = {  id_proyecto,  id_origen , codigo};



                $.ajax({
                type: 'post',
                //url: '/revit/crearLicencia',
                url: '/revit/validarCodigo',
                data: informacion,
                dataType: 'text'
                })
                .done(function (response) {
                    //console.log(resultado);
                    
                     var resultado = JSON.parse(response);
                    
                    if (resultado.error == 0)
                     {
                         toastr.success('Codigo Ingresado', 'Titulo', {
                                        "progressBar": true
                                    });

                         setTimeout(() => {  console.log("ejecutando");
                                            
                                            }
                                        , 5000);

                        location.reload();
                     }
                     else if (resultado.error == 1)
                     {
                         toastr.error(resultado.tipo, 'Titulo', {
                                        "progressBar": true
                                    });

                         setTimeout(() => {                                             
                                            }
                                        , 5000);
                     }

                });
            }
            else
            {
                toastr.error("Ingresar los campos solicitado", 'Crear Configuración General', {
                                        "progressBar": true
                                    });
            }




}
</script>